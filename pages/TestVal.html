<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Test Validating plugin</title>
    <link rel="stylesheet" type="text/css" href="../resources/css/bootstrap.min.css">
    <!-- Optional Bootstrap theme -->
    <link rel="stylesheet" href="../resources/css/bootstrap-theme.min.css">
    <script src="../resources/js/jquery-3.1.1.min.js"></script>
    <script src="../resources/js/bootstrap.min.js"></script>
    <script src="../resources/js/validator.js"></script>
</head>
<body>
<form id="resultsform" class="form-horizontal" data-toggle="validator" role="form" onsubmit="act()">
    <div class="ncontainer" style="padding-right: 15px;">
        <label for="languageresult" class="control-label col-xs-offset-2 col-sm-offset-0 col-xs-2 col-sm-2 col-md-2 col-lg-1">
            Text
        </label>
        <div class="form-group col-xs-8 col-sm-4 col-md-4 col-lg-3">
            <div class="input-group" title="Note: 0 ... 5, eine Kommastelle">
                <span class="input-group-addon"><span class="glyphicon glyphicon-file"></span></span>
                <input type="text" class="form-control" value="42" id="languageresult"
                       pattern="5|[0-4][,.]" style="width: 5em">
            </div>
            <div class="help-block with-errors"></div>
        </div>
    </div>
    <div class="col-xs-11 col-xs-offset-1" style="margin-top: 3em;">
        <button id="send-results" type="button" class="btn btn-primary">Send</button>
        <button id="submit-results" type="submit" class="btn btn-primary">Submit</button>
    </div>
</form>
<script type="text/javascript">
    // called when this html fragment is loaded,
    // so all element configurations can be done here
    $(document).ready(function () {
        // set action listener functions
        $('#change-results').click(enableCoreData);
        $('#submit-results').click(postResults);
        $('#resultsform').validator('update')
        $("#resultsform").on('valid.bs.validator', function() {
            if(testFormValid('#resultsform'))
                alert('form now valid');
        });
        $("#resultsform").on('invalid.bs.validator', function() {
            alert('form now invalid');
        });
    });

    function act() {
        alert('action!');
    }

    // enable all input fields
    function enableCoreData() {
        $('#resultsform input[disabled]').removeAttr("disabled");
        $('#resultsform select[disabled]').removeAttr("disabled");
        $('#change-results').attr('disabled', 'disabled');
    }

    function testFormValid(form) {
        return $(form).validator('validate').has('.has-error').length == 0;
    }

    function postResults() {
        var formVars = $("#resultsform").serialize();
        //var valid = $("#resultsform").validator('validate').has('.has-error').length;
        var sid = $('#sresult').val();
        var idx = $('#sresult').prop('selectedIndex');
    }
</script>
</body>
</html>
